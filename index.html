<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šæµ·å¤©æ°” - å®æ—¶é¢„æŠ¥</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --glass: rgba(255, 255, 255, 0.2);
            --text-main: #ffffff;
            --warn-color: #ff4d4d;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; }

        body {
            background: var(--bg-gradient);
            background-attachment: fixed;
            color: var(--text-main);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 900px;
        }

        /* é¡¶éƒ¨æ ‡é¢˜ */
        header { text-align: center; margin-bottom: 30px; }
        header h1 { font-size: 2.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        header p { opacity: 0.8; margin-top: 5px; }

        /* é¢„è­¦æ¨¡å— */
        .alert-box {
            background: var(--warn-color);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none; /* é»˜è®¤éšè—ï¼Œæœ‰é¢„è­¦æ—¶æ˜¾ç¤º */
            animation: pulse 2s infinite;
        }

        /* æ ¸å¿ƒå¤©æ°”å¡ç‰‡ */
        .main-card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            margin-bottom: 25px;
        }

        .temp-now { font-size: 5rem; font-weight: bold; margin: 10px 0; }
        .temp-now span { font-size: 2rem; vertical-align: top; }

        /* è¯¦æƒ…æ•°æ®ç½‘æ ¼ */
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
        }

        /* 7å¤©é¢„æŠ¥åˆ—è¡¨ */
        .forecast-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .forecast-day {
            background: var(--glass);
            padding: 15px 25px;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.3s;
        }

        .forecast-day:hover { transform: scale(1.02); }

        /* å“åº”å¼è°ƒæ•´ */
        @media (min-width: 768px) {
            .forecast-list {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 10px;
            }
            .forecast-day {
                flex-direction: column;
                padding: 20px 10px;
                text-align: center;
            }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .aqi-good { color: #52c41a; font-weight: bold; }
        .aqi-mid { color: #faad14; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1 id="city">ä¸Šæµ·</h1>
        <p id="date">2026å¹´1æœˆ28æ—¥ æ˜ŸæœŸä¸‰</p>
    </header>

    <div id="weather-alert" class="alert-box">
        <strong>âš ï¸ å¼‚å¸¸å¤©æ°”é¢„è­¦ï¼š</strong> <span id="alert-text">ä»Šæ—¥é¢„è®¡æœ‰å¤§é£è“è‰²é¢„è­¦ï¼Œè¯·æ³¨æ„å‡ºè¡Œå®‰å…¨ã€‚</span>
    </div>

    <section class="main-card">
        <div id="condition" style="font-size: 1.5rem;">å¤šäº‘è½¬æ™´</div>
        <div class="temp-now">7<span>Â°C</span></div>
        <div class="details-grid">
            <div class="detail-item">
                <p>ç©ºæ°”è´¨é‡</p>
                <p id="aqi" class="aqi-good">45 ä¼˜</p>
            </div>
            <div class="detail-item">
                <p>é£åŠ›æé†’</p>
                <p id="wind">è¥¿åŒ—é£ 4çº§</p>
            </div>
            <div class="detail-item">
                <p>ç›¸å¯¹æ¹¿åº¦</p>
                <p>65%</p>
            </div>
        </div>
    </section>

    <h3 style="margin-bottom: 15px;">æœªæ¥7å¤©é¢„æŠ¥</h3>
    <section class="forecast-list" id="forecast-container">
        </section>
</div>

<script>
// 1. é…ç½®ä¿¡æ¯
const API_KEY = "793c97a29e61493782d3780951d83c05"; 
const CITY_ID = "101020100"; // ä¸Šæµ·
// ä½¿ç”¨ä½ æä¾›çš„ä¸“ç”¨åŸŸå
const BASE_URL = "https://n36hextae3.re.qweatherapi.com/v7";

async function fetchWeather() {
    try {
        // æ„å»ºè¯·æ±‚åœ°å€
        const urls = {
            now: `${BASE_URL}/weather/now?location=${CITY_ID}&key=${API_KEY}`,
            daily: `${BASE_URL}/weather/7d?location=${CITY_ID}&key=${API_KEY}`,
            air: `${BASE_URL}/air/now?location=${CITY_ID}&key=${API_KEY}`,
            warn: `${BASE_URL}/warning/now?location=${CITY_ID}&key=${API_KEY}`
        };

        // å‘èµ·å¹¶å‘è¯·æ±‚
        const [nowRes, dailyRes, airRes, warnRes] = await Promise.all([
            fetch(urls.now).then(res => res.json()),
            fetch(urls.daily).then(res => res.json()),
            fetch(urls.air).then(res => res.json()),
            fetch(urls.warn).then(res => res.json())
        ]);

        // æ£€æŸ¥æ ¸å¿ƒæ•°æ®ï¼ˆå®æ—¶å’Œé¢„æŠ¥ï¼‰æ˜¯å¦æˆåŠŸè¿”å›
        if (nowRes.code === "200" && dailyRes.code === "200") {
            updateUI(nowRes, dailyRes, airRes, warnRes);
            console.log("å¤©æ°”æ•°æ®æ›´æ–°æˆåŠŸï¼");
        } else {
            console.error("APIè¿”å›å¼‚å¸¸ç :", { now: nowRes.code, daily: dailyRes.code });
        }
    } catch (err) {
        console.error("ç½‘ç»œè¯·æ±‚é”™è¯¯:", err);
    }
}

function updateUI(now, daily, air, warn) {
    // 1. æ›´æ–°å®æ—¶å¤©æ°”å¡ç‰‡
    document.querySelector('.temp-now').innerHTML = `${now.now.temp}<span>Â°C</span>`;
    document.getElementById('condition').innerText = now.now.text;
    document.getElementById('wind').innerText = `${now.now.windDir} ${now.now.windScale}çº§`;

    // 2. æ›´æ–°ç©ºæ°”è´¨é‡
    if (air.code === "200") {
        const aqiVal = air.now.aqi;
        const aqiEl = document.getElementById('aqi');
        aqiEl.innerText = `${aqiVal} ${air.now.category}`;
        aqiEl.className = aqiVal <= 50 ? 'aqi-good' : (aqiVal <= 100 ? 'aqi-mid' : '');
    }

    // 3. æ›´æ–°é¢„è­¦ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
    const alertBox = document.getElementById('weather-alert');
    if (warn.code === "200" && warn.warning && warn.warning.length > 0) {
        alertBox.style.display = 'block';
        document.getElementById('alert-text').innerText = warn.warning[0].title;
    } else {
        alertBox.style.display = 'none';
    }

    // 4. æ›´æ–°æœªæ¥7å¤©é¢„æŠ¥åˆ—è¡¨
    const forecastContainer = document.getElementById('forecast-container');
    forecastContainer.innerHTML = ''; // æ¸…ç©ºåŠ è½½æ€

    daily.daily.forEach(item => {
        const dateObj = new Date(item.fxDate);
        const dayNames = ["å‘¨æ—¥", "å‘¨ä¸€", "å‘¨äºŒ", "å‘¨ä¸‰", "å‘¨å››", "å‘¨äº”", "å‘¨å…­"];
        const dayName = dayNames[dateObj.getDay()];
        
        const div = document.createElement('div');
        div.className = 'forecast-day';
        div.innerHTML = `
            <span style="font-weight:bold">${dayName}</span>
            <span>${item.fxDate.split('-').slice(1).join('-')}</span>
            <span style="font-size:1.5rem">${getWeatherIcon(item.textDay)}</span>
            <span>${item.tempMin}Â°/${item.tempMax}Â°</span>
        `;
        forecastContainer.appendChild(div);
    });
}

// å¤©æ°”ç°è±¡å›¾æ ‡æ˜ å°„
function getWeatherIcon(text) {
    if (text.includes("æ™´")) return "â˜€ï¸";
    if (text.includes("äº‘")) return "ğŸŒ¤ï¸";
    if (text.includes("é˜´")) return "â˜ï¸";
    if (text.includes("é›¨")) return "ğŸŒ§ï¸";
    if (text.includes("é›ª")) return "â„ï¸";
    return "ğŸŒ¡ï¸";
}

// å¯åŠ¨æ‰§è¡Œ
window.onload = () => {
    fetchWeather();
    const now = new Date();
    document.getElementById('date').innerText = `${now.getFullYear()}å¹´${now.getMonth()+1}æœˆ${now.getDate()}æ—¥`;
};
</script>

</body>
</html>